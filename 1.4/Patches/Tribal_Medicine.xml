<?xml version="1.0" encoding="utf-8"?>
<Patch>

	<Operation Class="XmlExtensions.FindMod">
		<mods>
			<li>Tribal Medicine 2.0</li>
		</mods>
		<caseTrue>
			<Operation Class="PatchOperationInsert">
				<xpath>Defs/XmlExtensions.SettingsMenuDef[modId="VR.MOPatches"]/settings/li[@Class="XmlExtensions.Setting.Numeric" and (label="Esoteric Studies:")]</xpath>
				<order>Append</order>
				<value>
					<li Class="XmlExtensions.Setting.Numeric">
						<key>tribal_medicine_mo_cost</key>
						<label>Tribal Medicine:</label>
						<defaultValue>1000</defaultValue>
						<min>500</min>
						<max>10000</max>
					</li>
				</value>
			</Operation>
		</caseTrue>
	</Operation>

	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>Tribal Medicine 2.0</li>
		</mods>
		<match Class="XmlExtensions.UseSetting">
			<modId>VR.MOPatches</modId><!--String that XML Extensions can identify your mod with-->
			<key>tribal_medicine_mo_cost</key><!--Key to identify the setting (only used internally, invisible to user)-->
			<defaultValue>1000</defaultValue><!--What you want the default value of the setting to be-->
			<apply>
				<Operation Class="PatchOperationReplace">
					<xpath>Defs/ResearchProjectDef[defName="TM_AncientTribalMedicine"]/baseCost</xpath>
					<value>
						<baseCost>{tribal_medicine_mo_cost}</baseCost><!--Use the setting's value-->
					</value>
				</Operation>
			</apply>
		</match>
	</Operation>

	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>Tribal Medicine 2.0</li>
		</mods>
		<match Class="PatchOperationSequence">
			<operations>

				<!-- Add Tribal to Cooking Table -->
				<li Class="PatchOperationAdd">
					<xpath>Defs/ThingDef[defName="TM_MedicineTribal" or @Name="TM_TeaBase"]/recipeMaker/recipeUsers</xpath>
					<value>
						<li>DankPyon_RusticCookingTable</li>
					</value>
				</li>

				<li Class="PatchOperationAdd">
					<xpath>Defs/ResearchProjectDef[defName="TM_AncientTribalMedicine"]</xpath>
					<value>
						<tab>DankPyon_MedievalResearchTab</tab>
					</value>
				</li>
				
				<li Class="PatchOperationReplace">
					<xpath>Defs/ResearchProjectDef[defName="TM_AncientTribalMedicine"]/researchViewX</xpath>
					<value>
						<researchViewX>4.00</researchViewX>
					</value>
				</li>
				
				<!--li Class="PatchOperationAdd">
					<xpath>Defs/ResearchProjectDef[defName="TM_AncientTribalMedicine"]</xpath>
					<value>
						<researchViewY>0.0</researchViewY>
					</value>
				</li-->

				<!-- Slightly reduce bonus -->
				<li Class="PatchOperationReplace">
					<xpath>Defs/StatDef[defName="MedicalQualityMax" or defName="MedicalPotency"]/parts/li[@Class="StatPart_Quality"]</xpath>
					<value>
						<li Class="StatPart_Quality">
							<factorAwful>0.4</factorAwful>
							<factorPoor>0.6</factorPoor>
							<factorNormal>1</factorNormal>
							<factorGood>1.1</factorGood>
							<factorExcellent>1.2</factorExcellent>
							<factorMasterwork>1.35</factorMasterwork>
							<factorLegendary>1.5</factorLegendary>
						</li>
					</value>
				</li>

			</operations>
		</match>
	</Operation>

</Patch>