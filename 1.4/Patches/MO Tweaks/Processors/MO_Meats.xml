<?xml version="1.0" encoding="utf-8" ?>
<Patch>
	
	<!-- Meat Rack -->
	<Operation Class="PatchOperationSequence">
		<operations>
		
			<li Class="PatchOperationConditional">
				<xpath>Defs/ThingDef[defName="DankPyon_DryingRack"]/comps/li[@Class="ItemProcessor.CompProperties_ItemProcessor"]</xpath>
				<match Class="PatchOperationRemove">
					<xpath>Defs/ThingDef[defName="DankPyon_DryingRack"]/comps/li[@Class="ItemProcessor.CompProperties_ItemProcessor"]</xpath>
				</match>
			</li>
			
			<li Class="PatchOperationConditional">
				<xpath>Defs/ThingDef[defName="DankPyon_DryingRack"]/drawerType</xpath>
				<nomatch Class="PatchOperationAdd">
					<xpath>Defs/ThingDef[defName="DankPyon_DryingRack"]</xpath>
					<value>
						<drawerType>MapMeshAndRealTime</drawerType>
					</value>
				</nomatch>
				<match Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="DankPyon_DryingRack"]/drawerType</xpath>
					<value>
						<drawerType>MapMeshAndRealTime</drawerType>
					</value>
				</match>
			</li>
			
			<li Class="PatchOperationAdd">
				<xpath>Defs</xpath>
				<value>
			
					<!-- Dried Human Meat Process-->
					<ProcessorFramework.ProcessDef>
						<defName>DankPyon_DriedMeatHumanProcess</defName>
						<thingDef>DankPyon_DriedMeat_Human</thingDef>
						<ingredientFilter>
							<thingDefs>
								<li>Meat_Human</li>
							</thingDefs>
							<disallowedThingDefs>
								<li>DankPyon_DriedMeat_Human</li>
							</disallowedThingDefs>
						</ingredientFilter>
						<processDays>2.5</processDays><!-- in days, a day is 60,000 ticks -->
						<capacityFactor>1.0</capacityFactor>
						<efficiency>1</efficiency>
						<usesTemperature>true</usesTemperature>
						<temperatureSafe>-99.0~99.0</temperatureSafe>
						<temperatureIdeal>21.0~99.0</temperatureIdeal>
						<ruinedPerDegreePerHour>2.5</ruinedPerDegreePerHour><!-- percent per degree per hour -->
						<speedBelowSafe>0.1</speedBelowSafe>
						<speedAboveSafe>1.0</speedAboveSafe>
						<sunFactor>0.5~1</sunFactor>
						<rainFactor>1.0~0.0</rainFactor>
						<snowFactor>1.0~0.0</snowFactor>
						<windFactor>0.75~1.25</windFactor>
						<unpoweredFactor>0.0</unpoweredFactor>
						<unfueledFactor>0.0</unfueledFactor>
						<powerUseFactor>1.0</powerUseFactor>
						<fuelUseFactor>0.0</fuelUseFactor>
						<filledGraphicSuffix>FilledMeat</filledGraphicSuffix>
						<usesQuality>false</usesQuality>
						<qualityDays>(1, 2, 3, 4, 5, 6, 7)</qualityDays>
						<color>(255, 255, 255)</color><!-- 0-255 or 0.0-1.0 -->
						<customLabel/>
						<destroyChance>0.0</destroyChance>
  
					</ProcessorFramework.ProcessDef>
			
					<!-- Dried Meats -->
					<ThingDef ParentName="OrganicProductBase">
						<defName>DankPyon_DriedMeat_Human</defName>
						<label>Dried Human Meat</label>
						<description>Dried human meat to preserve and prolong shelf life.</description>
						<graphicData>
							<texPath>Meal/DriedMeat</texPath>
							<graphicClass>Graphic_StackCount</graphicClass>
						</graphicData>
						<thingCategories>
							<li>Foods</li>
							<li>MeatRaw</li>
						</thingCategories>
						<statBases>
							<Mass>0.01</Mass>
							<MarketValue>2.5</MarketValue>
							<Nutrition>0.05</Nutrition>
						</statBases>
						<ingredient>
							<mergeCompatibilityTags>
								<li MayRequire="Ludeon.RimWorld.Ideology">Cannibal</li>
								<li MayRequire="Ludeon.RimWorld.Ideology">Cannibalism</li>
								<li MayRequire="Ludeon.RimWorld.Ideology">HumanMeat</li>
							</mergeCompatibilityTags>
						</ingredient>
						<ingestible>
							<foodType>Meat</foodType>
							<preferability>DesperateOnly</preferability>
							<ingestEffect>EatMeat</ingestEffect>
							<ingestSound>RawMeat_Eat</ingestSound>
							<tasteThought>AteHumanlikeMeatDirect</tasteThought>
							<specialThoughtDirect>AteHumanlikeMeatDirectCannibal</specialThoughtDirect>
							<specialThoughtAsIngredient>AteHumanlikeMeatAsIngredientCannibal</specialThoughtAsIngredient>
							<optimalityOffsetHumanlikes>-5</optimalityOffsetHumanlikes>
							<optimalityOffsetFeedingAnimals>-10</optimalityOffsetFeedingAnimals>
						</ingestible>
						<comps>
							<li Class="CompProperties_Rottable">
								<daysToRotStart>60</daysToRotStart>
								<rotDestroys>true</rotDestroys>
							</li>
							<li Class="CompProperties_Ingredients"/>
						</comps>
						<rotatable>false</rotatable>
						<tradeability>Buyable</tradeability>
					</ThingDef>
					
					<!-- Dried Insect Meat Process-->
					<ProcessorFramework.ProcessDef>
						<defName>DankPyon_DriedMeatInsectProcess</defName>
						<thingDef>DankPyon_DriedMeat_Insect</thingDef>
						<ingredientFilter>
							<thingDefs>
								<li>Meat_Megaspider</li>
							</thingDefs>
						</ingredientFilter>
						<processDays>2.5</processDays><!-- in days, a day is 60,000 ticks -->
						<capacityFactor>1.0</capacityFactor>
						<efficiency>1</efficiency>
						<usesTemperature>true</usesTemperature>
						<temperatureSafe>-99.0~99.0</temperatureSafe>
						<temperatureIdeal>21.0~99.0</temperatureIdeal>
						<ruinedPerDegreePerHour>2.5</ruinedPerDegreePerHour><!-- percent per degree per hour -->
						<speedBelowSafe>0.1</speedBelowSafe>
						<speedAboveSafe>1.0</speedAboveSafe>
						<sunFactor>0.5~1</sunFactor>
						<rainFactor>1.0~0.0</rainFactor>
						<snowFactor>1.0~0.0</snowFactor>
						<windFactor>0.75~1.25</windFactor>
						<unpoweredFactor>0.0</unpoweredFactor>
						<unfueledFactor>0.0</unfueledFactor>
						<powerUseFactor>1.0</powerUseFactor>
						<fuelUseFactor>0.0</fuelUseFactor>
						<filledGraphicSuffix>FilledMeat</filledGraphicSuffix>
						<usesQuality>false</usesQuality>
						<qualityDays>(1, 2, 3, 4, 5, 6, 7)</qualityDays>
						<color>(255, 255, 255)</color><!-- 0-255 or 0.0-1.0 -->
						<customLabel/>
						<destroyChance>0.0</destroyChance>
  
					</ProcessorFramework.ProcessDef>
			
					<!-- Dried Meats -->
					<ThingDef ParentName="OrganicProductBase">
						<defName>DankPyon_DriedMeat_Insect</defName>
						<label>Dried Insect Meat</label>
						<description>Dried insect meat to preserve and prolong shelf life.</description>
						<graphicData>
							<texPath>Meal/DriedMeat</texPath>
							<graphicClass>Graphic_StackCount</graphicClass>
						</graphicData>
						<thingCategories>
							<li>Foods</li>
							<li>MeatRaw</li>
						</thingCategories>
						<statBases>
							<Mass>0.01</Mass>
							<MarketValue>2.5</MarketValue>
							<Nutrition>0.05</Nutrition>
						</statBases>
						<ingestible>
							<foodType>Meat</foodType>
							<preferability>DesperateOnly</preferability>
							<ingestEffect>EatMeat</ingestEffect>
							<ingestSound>RawMeat_Eat</ingestSound>
							<optimalityOffsetHumanlikes>-5</optimalityOffsetHumanlikes>
							<optimalityOffsetFeedingAnimals>-10</optimalityOffsetFeedingAnimals>
							<specialThoughtDirect>AteInsectMeatDirect</specialThoughtDirect>
							<specialThoughtAsIngredient>AteInsectMeatAsIngredient</specialThoughtAsIngredient>
						</ingestible>
						<comps>
							<li Class="CompProperties_Rottable">
								<daysToRotStart>60</daysToRotStart>
								<rotDestroys>true</rotDestroys>
							</li>
							<li Class="CompProperties_Ingredients"/>
						</comps>
						<rotatable>false</rotatable>
						<tradeability>Buyable</tradeability>
					</ThingDef>
				</value>
			</li>
			
			<li Class="PatchOperationConditional">
				<xpath>Defs/ThingDef[defName="DankPyon_DryingRack"]/comps/li[@Class="ProcessorFramework.CompProperties_Processor"]</xpath>
				<nomatch Class="PatchOperationAdd">
					<xpath>Defs/ThingDef[defName="DankPyon_DryingRack"]/comps</xpath>
					<value>
						<li Class="ProcessorFramework.CompProperties_Processor">
							<capacity>200</capacity>
							<independentProcesses>true</independentProcesses>
							<parallelProcesses>true</parallelProcesses>
							<dropIngredients>true</dropIngredients>
							<showProductIcon>true</showProductIcon>
							<barOffset>(0.0, 0.25)</barOffset>
							<barScale>(1.0, 1.0)</barScale>
							<colorCoded>false</colorCoded>
							<processes>
								<li>DankPyon_DriedMeatProcess</li>
								<li>DankPyon_DriedMeatHumanProcess</li>
								<li>DankPyon_DriedMeatInsectProcess</li>
							</processes>
						</li>
					</value>
				</nomatch>
			</li>
	
			<li Class="PatchOperationConditional">
				<xpath>Defs/ThingDef[defName="DankPyon_DryingRack"]/thingClass[.="ItemProcessor.Building_ItemProcessor"]</xpath>
				<match Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="DankPyon_DryingRack"]/thingClass</xpath>
					<value>
						<thingClass>Building_WorkTable</thingClass>
					</value>
				</match>
			</li>
			
		</operations>
	</Operation>
	
	
	<!-- Dried Meat -->
	<Operation Class="PatchOperationAttributeSet">
		<xpath>Defs/ThingDef[defName="DankPyon_DriedMeat"]</xpath>
		<attribute>ParentName</attribute>
		<value>OrganicProductBase</value>
	</Operation>
	
	<Operation Class="PatchOperationConditional">
		<xpath>Defs/ThingDef[defName="DankPyon_DriedMeat"]/thingCategories</xpath>
		<match Class="PatchOperationRemove">
			<xpath>Defs/ThingDef[defName="DankPyon_DriedMeat"]/thingCategories</xpath>
		</match>
	</Operation>
	
	<Operation Class="PatchOperationAdd">
		<xpath>Defs/ThingDef[defName="DankPyon_DriedMeat"]</xpath>
		<value>
			<thingCategories>
				<li>Foods</li>
				<li>MeatRaw</li>
			</thingCategories>
		</value>
	</Operation>
	
	<Operation Class="PatchOperationReplace">
		<xpath>Defs/ThingDef[defName="DankPyon_DriedMeat"]/statBases</xpath>
		<value>
			<statBases>
				<MarketValue>2.5</MarketValue>
				<Mass>0.01</Mass>
				<Nutrition>0.05</Nutrition>
			</statBases>
		</value>
	</Operation>
	
	<Operation Class="PatchOperationReplace">
		<xpath>Defs/ThingDef[defName="DankPyon_DriedMeat"]/ingestible</xpath>
		<value>
			<ingestible>
				<foodType>Meat</foodType>
				<preferability>DesperateOnly</preferability>
				<ingestEffect>EatMeat</ingestEffect>
				<ingestSound>RawMeat_Eat</ingestSound>
				<optimalityOffsetHumanlikes>-5</optimalityOffsetHumanlikes>
				<optimalityOffsetFeedingAnimals>-10</optimalityOffsetFeedingAnimals>
			</ingestible>
		</value>
	</Operation>
	
	<Operation Class="PatchOperationReplace">
		<xpath>Defs/ThingDef[defName="DankPyon_DriedMeat"]/comps</xpath>
		<value>
			<comps>
				<li Class="CompProperties_Rottable">
					<daysToRotStart>60</daysToRotStart>
					<rotDestroys>true</rotDestroys>
				</li>
				<li Class="CompProperties_Ingredients"/>
			</comps>
		</value>
	</Operation>
	
	<!-- Meat Process Weather -->
	<Operation Class="PatchOperationReplace">
		<xpath>Defs/ProcessorFramework.ProcessDef[defName="DankPyon_DriedMeatProcess"]/sunFactor</xpath>
		<value>
			<sunFactor>0.5~1</sunFactor>
		</value>
	</Operation>
	
	<Operation Class="PatchOperationReplace">
		<xpath>Defs/ProcessorFramework.ProcessDef[defName="DankPyon_DriedMeatProcess"]/windFactor</xpath>
		<value>
			<windFactor>0.75~1.25</windFactor>
		</value>
	</Operation>
	
	<!-- 1:1 Meat to Dried -->
	<Operation Class="PatchOperationReplace">
		<xpath>Defs/ProcessorFramework.ProcessDef[defName="DankPyon_DriedMeatProcess"]/efficiency</xpath>
		<value>
			<efficiency>1</efficiency>
		</value>
	</Operation>
	
	<!-- Prevent Drying  -->
	<Operation Class="PatchOperationConditional">
		<xpath>Defs/ProcessorFramework.ProcessDef[defName="DankPyon_DriedMeatProcess"]/ingredientFilter/disallowedThingDefs</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>Defs/ProcessorFramework.ProcessDef[defName="DankPyon_DriedMeatProcess"]/ingredientFilter/</xpath>
			<value>
				<disallowedThingDefs>
					<li>DankPyon_DriedMeat</li>
					<li>DankPyon_SmokedMeat</li>
					<li>Meat_Human</li>
					<li>Meat_Megaspider</li>
					<li>DankPyon_DriedMeat_Human</li>
					<li>DankPyon_SmokedMeat_Human</li>
					<li>DankPyon_DriedMeat_Insect</li>
				</disallowedThingDefs>
			</value>
		</nomatch>
		<match Class="PatchOperationAdd">
			<xpath>Defs/ProcessorFramework.ProcessDef[defName="DankPyon_DriedMeatProcess"]/ingredientFilter/disallowedThingDefs</xpath>
			<value>
				<li>DankPyon_DriedMeat</li>
				<li>DankPyon_SmokedMeat</li>
				<li>Meat_Human</li>
				<li>Meat_Megaspider</li>
				<li>DankPyon_DriedMeat_Human</li>
				<li>DankPyon_SmokedMeat_Human</li>
				<li>DankPyon_DriedMeat_Insect</li>
			</value>
		</match>
	</Operation>
	
</Patch>