<?xml version="1.0" encoding="utf-8" ?>
<Patch>

	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>Combat Extended</li>
		</mods>
		<match Class="PatchOperationSequence">
			<operations>
				
				<!-- MO Handgonne -->
				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="DankPyon_Handgonne"]/recipeMaker/researchPrerequisite</xpath>
					<value>
						<researchPrerequisite>CE_Gunpowder</researchPrerequisite>
					</value>
				</li>
				
				<!-- MO Grenades -->
				<li Class="PatchOperationReplace">
					<xpath>Defs/RecipeDef[defName="MakeFireBomb" or defName="MakeSmokeBomb" or defName="MakeSmokeFlashBomb"]/researchPrerequisite</xpath>
					<value>
						<researchPrerequisite>CE_Gunpowder</researchPrerequisite>
					</value>
				</li>
				
				<li Class="PatchOperationReplace">
					<xpath>Defs/RecipeDef[defName="MakeSmokeFlashBomb"]/label</xpath>
					<value>
						<label>make flash bombs x10</label>
					</value>
				</li>
				
				<li Class="PatchOperationReplace">
					<xpath>Defs/RecipeDef[defName="MakeSmokeFlashBomb"]/description</xpath>
					<value>
						<description>Craft 10 flash bombs.</description>
					</value>
				</li>
				
				<li Class="PatchOperationReplace">
					<xpath>Defs/RecipeDef[defName="MakeSmokeFlashBomb"]/jobString</xpath>
					<value>
						<jobString>Making flash bombs.</jobString>
					</value>
				</li>
				<!-- Gunpowder and a CE fix -->
				<li Class="PatchOperationReplace">
					<xpath>Defs/RecipeDef[defName="DankPyon_MakeGunpowder" or defName="DankPyon_MakeGunpowderBulk"]/researchPrerequisites</xpath>
					<value>
						<researchPrerequisite>
							<li>CE_Gunpowder</li>
						</researchPrerequisite>
					</value>
				</li>
				<!-- Gunpowder and a CE fix -->
				<li Class="PatchOperationReplace">
					<xpath>Defs/RecipeDef[defName="MakeAmmo_MusketBall"]/researchPrerequisite</xpath>
					<value>
						<researchPrerequisite>CE_Gunpowder</researchPrerequisite>
					</value>
				</li>
				
				<!-- CE Gunpowder Replace MO Gunpowder -->
				<li Class="PatchOperationReplace">
					<xpath>Defs/ResearchProjectDef[defName="CE_Gunpowder"]/prerequisites</xpath>
					<value>
						<prerequisites>
							<li>DankPyon_Alchemy</li>
						</prerequisites>
						<requiredResearchFacilities>
							<li>DankPyon_Book_Gunpowder</li>
						</requiredResearchFacilities>
						<tab>DankPyon_MedievalResearchTab</tab>
					</value>
				</li>
				
				<li Class="PatchOperationReplace">
					<xpath>Defs/ResearchProjectDef[defName="CE_Gunpowder"]/baseCost</xpath>
					<value>
						<baseCost>1000</baseCost>
					</value>
				</li>
				
				<li Class="PatchOperationReplace">
					<xpath>Defs/ResearchProjectDef[defName="CE_Gunpowder"]/researchViewX</xpath>
					<value>
						<researchViewX>15.00</researchViewX>
					</value>
				</li>
				
				<li Class="PatchOperationReplace">
					<xpath>Defs/ResearchProjectDef[defName="CE_Gunpowder"]/researchViewY</xpath>
					<value>
						<researchViewY>5.75</researchViewY>
					</value>
				</li>
				
				<li Class="PatchOperationConditional">
					<xpath>Defs/ResearchProjectDef[defName="DankPyon_Gunpowder"]</xpath>
					<match Class="PatchOperationRemove">
						<xpath>Defs/ResearchProjectDef[defName="DankPyon_Gunpowder"]</xpath>
					</match>
				</li>
				
			</operations>
		</match>
	</Operation>
	
</Patch>
